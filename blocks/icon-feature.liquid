{% doc %}
  @name Icon Feature Block
  @description A feature block with icon, heading, and description text
  @category Features
{% enddoc %}

{%- liquid
  assign icon_size = block.settings.icon_size | default: 'medium'
  case icon_size
    when 'small'
      assign size_class = 'icon-feature-block--sm'
      assign icon_dimension = 48
    when 'large'
      assign size_class = 'icon-feature-block--lg'
      assign icon_dimension = 80
    else
      assign size_class = 'icon-feature-block--md'
      assign icon_dimension = 64
  endcase
-%}

<div class="icon-feature-block {{ size_class }}" {{ block.shopify_attributes }}>
  <div class="icon-feature-block__icon" style="--icon-size: {{ icon_dimension }}px;">
    {%- if block.settings.custom_icon != blank -%}
      <img
        src="{{ block.settings.custom_icon | image_url: width: icon_dimension | times: 2 }}"
        alt=""
        width="{{ icon_dimension }}"
        height="{{ icon_dimension }}"
        loading="lazy"
      >
    {%- else -%}
      {%- render 'icon', name: block.settings.icon -%}
    {%- endif -%}
  </div>

  {%- if block.settings.title != blank -%}
    <h3 class="icon-feature-block__title">{{ block.settings.title }}</h3>
  {%- endif -%}

  {%- if block.settings.text != blank -%}
    <p class="icon-feature-block__text">{{ block.settings.text }}</p>
  {%- endif -%}

  {%- if block.settings.link != blank and block.settings.link_text != blank -%}
    <a href="{{ block.settings.link }}" class="icon-feature-block__link">
      {{ block.settings.link_text }}
      <svg width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
        <path d="M5 12h14M12 5l7 7-7 7"/>
      </svg>
    </a>
  {%- endif -%}
</div>

{% stylesheet %}
.icon-feature-block {
  text-align: center;
  padding: var(--spacing-md, 1.5rem);
}

.icon-feature-block__icon {
  width: var(--icon-size, 64px);
  height: var(--icon-size, 64px);
  margin: 0 auto var(--spacing-sm, 1rem);
  display: flex;
  align-items: center;
  justify-content: center;
  background: var(--color-primary);
  border-radius: 50%;
  color: white;
}

.icon-feature-block__icon svg {
  width: 50%;
  height: 50%;
}

.icon-feature-block__icon img {
  width: 100%;
  height: 100%;
  object-fit: contain;
}

.icon-feature-block__title {
  margin: 0 0 0.5rem;
  font-size: 1.125rem;
  font-weight: 600;
  color: var(--color-heading);
}

.icon-feature-block__text {
  margin: 0;
  color: var(--color-text-light);
  line-height: 1.6;
}

.icon-feature-block__link {
  display: inline-flex;
  align-items: center;
  gap: 0.25rem;
  margin-top: 1rem;
  font-weight: 500;
  color: var(--color-primary);
  text-decoration: none;
}

.icon-feature-block__link:hover {
  text-decoration: underline;
}

/* Size variants */
.icon-feature-block--sm .icon-feature-block__icon {
  --icon-size: 48px;
}

.icon-feature-block--lg .icon-feature-block__icon {
  --icon-size: 80px;
}
{% endstylesheet %}

{% schema %}
{
  "name": "Icon Feature",
  "category": "Features",
  "settings": [
    {
      "type": "select",
      "id": "icon",
      "label": "Icon",
      "options": [
        { "value": "shield", "label": "Shield" },
        { "value": "check", "label": "Checkmark" },
        { "value": "award", "label": "Award" },
        { "value": "heart", "label": "Heart" },
        { "value": "truck", "label": "Truck" },
        { "value": "phone", "label": "Phone" },
        { "value": "clock", "label": "Clock" },
        { "value": "star", "label": "Star" },
        { "value": "users", "label": "Users" },
        { "value": "refresh", "label": "Refresh" }
      ],
      "default": "shield"
    },
    {
      "type": "image_picker",
      "id": "custom_icon",
      "label": "Custom icon image",
      "info": "Overrides the selected icon above"
    },
    {
      "type": "select",
      "id": "icon_size",
      "label": "Icon size",
      "options": [
        { "value": "small", "label": "Small" },
        { "value": "medium", "label": "Medium" },
        { "value": "large", "label": "Large" }
      ],
      "default": "medium"
    },
    {
      "type": "text",
      "id": "title",
      "label": "Heading",
      "default": "Feature"
    },
    {
      "type": "textarea",
      "id": "text",
      "label": "Description",
      "default": "Describe this feature in a few words."
    },
    {
      "type": "url",
      "id": "link",
      "label": "Link"
    },
    {
      "type": "text",
      "id": "link_text",
      "label": "Link text",
      "default": "Learn more"
    }
  ],
  "presets": [
    {
      "name": "Icon Feature",
      "category": "Features"
    }
  ]
}
{% endschema %}
