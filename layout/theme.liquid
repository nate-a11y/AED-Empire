<!doctype html>
<html class="no-js" lang="{{ request.locale.iso_code }}" dir="{{ request.locale.direction | default: 'ltr' }}">
<head>
  <meta charset="utf-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0">
  <meta name="theme-color" content="{{ settings.color_primary | default: '#C93C3C' }}">

  <title>{{ page_title }}{% unless page_title contains shop.name %} â€” {{ shop.name }}{% endunless %}</title>

  {% if page_description %}<meta name="description" content="{{ page_description | escape }}">{% endif %}
  <link rel="canonical" href="{{ canonical_url }}">

  {%- comment -%} Robots meta for search engine control {%- endcomment -%}
  {% if template contains 'search' or template contains 'cart' or template contains 'customers' %}
  <meta name="robots" content="noindex, nofollow">
  {% endif %}

  {%- comment -%} Social Meta Tags {%- endcomment -%}
  {% render 'social-meta' %}

  {%- comment -%} Favicons & App Icons {%- endcomment -%}
  {% if settings.favicon %}
  <link rel="icon" type="image/png" sizes="32x32" href="{{ settings.favicon | image_url: width: 32 }}">
  <link rel="icon" type="image/png" sizes="16x16" href="{{ settings.favicon | image_url: width: 16 }}">
  <link rel="apple-touch-icon" sizes="180x180" href="{{ settings.favicon | image_url: width: 180 }}">
  {% endif %}

  {%- comment -%} PWA Manifest {%- endcomment -%}
  <link rel="manifest" href="{{ 'manifest.json' | asset_url }}">
  <meta name="apple-mobile-web-app-capable" content="yes">
  <meta name="apple-mobile-web-app-status-bar-style" content="default">
  <meta name="apple-mobile-web-app-title" content="{{ shop.name }}">
  <meta name="application-name" content="{{ shop.name }}">
  <meta name="msapplication-TileColor" content="{{ settings.color_primary | default: '#C93C3C' }}">

  {%- comment -%} Preconnect to critical origins {%- endcomment -%}
  <link rel="preconnect" href="https://fonts.shopifycdn.com" crossorigin>
  <link rel="preconnect" href="https://cdn.shopify.com" crossorigin>
  <link rel="preconnect" href="https://monorail-edge.shopifysvc.com" crossorigin>
  {% if settings.google_analytics_id %}
  <link rel="preconnect" href="https://www.google-analytics.com" crossorigin>
  <link rel="preconnect" href="https://www.googletagmanager.com" crossorigin>
  {% endif %}

  {%- comment -%} DNS Prefetch for third-party services {%- endcomment -%}
  <link rel="dns-prefetch" href="https://productreviews.shopifycdn.com">
  <link rel="dns-prefetch" href="https://ajax.googleapis.com">

  {%- comment -%} Preload critical assets {%- endcomment -%}
  <link rel="preload" as="style" href="{{ 'theme.css' | asset_url }}">
  <link rel="preload" as="script" href="{{ 'theme.js' | asset_url }}">

  {%- comment -%} Font declarations with font-display: swap {%- endcomment -%}
  <style>
    {{ settings.font_heading | font_face: font_display: 'swap' }}
    {{ settings.font_body | font_face: font_display: 'swap' }}
  </style>

  {%- comment -%} Main stylesheet {%- endcomment -%}
  {{ 'theme.css' | asset_url | stylesheet_tag }}

  {%- comment -%} CSS Custom Properties - Winter '26 Edition with OKLCH Support {%- endcomment -%}
  {%- comment -%} Brand Colors from AED Empire Logo {%- endcomment -%}
  <style>
    :root {
      /* AED Empire Brand Colors - Extracted from Logo */
      --color-primary: {{ settings.color_primary | default: '#C93C3C' }};          /* Heart Red - "AED" text */
      --color-primary-hover: {{ settings.color_primary_hover | default: '#A82E2E' }};
      --color-secondary: {{ settings.color_secondary | default: '#1E4B8E' }};       /* Shield Navy - "EMPIRE" text */
      --color-accent: {{ settings.color_accent | default: '#2B5797' }};             /* Royal Blue accent */
      --color-bg: {{ settings.color_background | default: '#FFFFFF' }};
      --color-bg-alt: {{ settings.color_background_alt | default: '#F5F7FA' }};
      --color-bg-dark: {{ settings.color_secondary | default: '#1E4B8E' }};
      --color-text: {{ settings.color_text | default: '#1A1A2E' }};
      --color-text-light: {{ settings.color_text_light | default: '#5A5A6E' }};
      --color-border: {{ settings.color_border | default: '#E1E5EB' }};
      --color-sale: {{ settings.color_sale | default: '#2E7D32' }};
      --color-error: {{ settings.color_error | default: '#dc3545' }};
      --color-success: {{ settings.color_success | default: '#28a745' }};
      --color-star: #f59e0b;
      --color-focus: var(--color-primary);
      --font-heading: {{ settings.font_heading.family }}, {{ settings.font_heading.fallback_families }};
      --font-body: {{ settings.font_body.family }}, {{ settings.font_body.fallback_families }};
      --font-size-base: {{ settings.font_body_size | default: 16 }}px;
      --page-width: {{ settings.page_width | default: 1400 }}px;
      --spacing-sections: {{ settings.spacing_sections | default: 80 }}px;
      --spacing-sm: 0.5rem;
      --spacing-md: 1rem;
      --spacing-lg: 2rem;
      --spacing-xl: 3rem;
      --button-radius: {{ settings.button_border_radius | default: 0 }}px;
      --border-radius: 8px;
    }

    /* OKLCH Color Support (Winter '26) - Progressive enhancement */
    @supports (color: oklch(0% 0 0)) {
      :root {
        /* OKLCH provides wider color gamut and perceptual uniformity */
        /* AED Empire brand colors in OKLCH */
        --color-primary-oklch: oklch(0.55 0.18 25);      /* Heart Red */
        --color-secondary-oklch: oklch(0.38 0.12 250);   /* Shield Navy */
        --color-accent-oklch: oklch(0.45 0.12 250);      /* Royal Blue */
        --color-success-oklch: oklch(0.55 0.15 145);
        --color-error-oklch: oklch(0.55 0.2 25);
        --color-star-oklch: oklch(0.75 0.15 85);

        /* Dynamic color mixing with OKLCH */
        --color-primary-dark: color-mix(in oklch, var(--color-primary), black 20%);
        --color-primary-light: color-mix(in oklch, var(--color-primary), white 30%);
        --color-secondary-dark: color-mix(in oklch, var(--color-secondary), black 15%);
        --color-secondary-light: color-mix(in oklch, var(--color-secondary), white 30%);

        /* Translucent variants for overlays */
        --color-primary-translucent: color-mix(in oklch, var(--color-primary), transparent 80%);
        --color-secondary-translucent: color-mix(in oklch, var(--color-secondary), transparent 80%);
      }
    }

    /* Reduced motion support */
    @media (prefers-reduced-motion: reduce) {
      *, *::before, *::after {
        animation-duration: 0.01ms !important;
        animation-iteration-count: 1 !important;
        transition-duration: 0.01ms !important;
        scroll-behavior: auto !important;
      }
    }

    /* High contrast mode support */
    @media (prefers-contrast: high) {
      :root {
        --color-border: #000;
      }
      .btn { border-width: 3px; }
    }

    /* Print styles */
    @media print {
      .header__main, .footer, .cart-drawer, .mobile-menu,
      .back-to-top, .cookie-consent, .newsletter-popup,
      .announcement-bar, .trust-bar, .skip-link { display: none !important; }
      body { font-size: 12pt; color: #000; background: #fff; }
      a { color: #000; text-decoration: underline; }
      .container { max-width: 100%; padding: 0; }
      .product-gallery__thumbs { display: none; }
      .btn { border: 1px solid #000; background: #fff; color: #000; }
    }
  </style>

  {{ content_for_header }}

  {%- comment -%} Google Analytics 4 {%- endcomment -%}
  {% if settings.google_analytics_id %}
  <script async src="https://www.googletagmanager.com/gtag/js?id={{ settings.google_analytics_id }}"></script>
  <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());
    gtag('config', '{{ settings.google_analytics_id }}', {
      'anonymize_ip': true,
      'cookie_flags': 'SameSite=None;Secure'
    });
  </script>
  {% endif %}

  {%- comment -%} Facebook Pixel {%- endcomment -%}
  {% if settings.facebook_pixel_id %}
  <script>
    !function(f,b,e,v,n,t,s)
    {if(f.fbq)return;n=f.fbq=function(){n.callMethod?
    n.callMethod.apply(n,arguments):n.queue.push(arguments)};
    if(!f._fbq)f._fbq=n;n.push=n;n.loaded=!0;n.version='2.0';
    n.queue=[];t=b.createElement(e);t.async=!0;
    t.src=v;s=b.getElementsByTagName(e)[0];
    s.parentNode.insertBefore(t,s)}(window, document,'script',
    'https://connect.facebook.net/en_US/fbevents.js');
    fbq('init', '{{ settings.facebook_pixel_id }}');
    fbq('track', 'PageView');
  </script>
  <noscript><img height="1" width="1" style="display:none" src="https://www.facebook.com/tr?id={{ settings.facebook_pixel_id }}&ev=PageView&noscript=1"/></noscript>
  {% endif %}

  <script>document.documentElement.className = document.documentElement.className.replace('no-js', 'js');</script>

{% comment %}
  Organization and Website structured data
  Should be included in theme.liquid <head>
{% endcomment %}

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Organization",
  "name": "AED Empire",
  "legalName": "AED Empire",
  "url": "https://www.aedempire.com",
  "logo": "https://www.aedempire.com/cdn/shop/files/AED_Empire_Logo.png",
  "description": "Professional AED sales and training by Firefighter/Paramedic experts. Free shipping on all defibrillators. Expert support for AED selection, compliance, and maintenance.",
  "email": "Dustin@TalackoSafetySolutions.com",
  "telephone": "+1-402-968-3712",
  "address": {
    "@type": "PostalAddress",
    "addressCountry": "US",
    "addressRegion": "NE"
  },
  "founder": [
    {
      "@type": "Person",
      "name": "Dustin Talacko",
      "jobTitle": "President, Firefighter/Paramedic"
    },
    {
      "@type": "Person",
      "name": "Jill Talacko",
      "jobTitle": "CEO"
    }
  ],
  "sameAs": [
    "https://www.facebook.com/AEDEmpire",
    "https://www.linkedin.com/company/aed-empire"
  ],
  "areaServed": {
    "@type": "Country",
    "name": "United States"
  },
  "knowsAbout": [
    "Automated External Defibrillators",
    "AED Compliance",
    "Emergency Medical Equipment",
    "CPR Training",
    "Stop the Bleed Training",
    "AED Maintenance"
  ]
}
</script>

<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "WebSite",
  "name": "AED Empire",
  "url": "https://www.aedempire.com",
  "potentialAction": {
    "@type": "SearchAction",
    "target": {
      "@type": "EntryPoint",
      "urlTemplate": "https://www.aedempire.com/search?q={search_term_string}"
    },
    "query-input": "required name=search_term_string"
  }
}
</script>


<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('âœ… Quick View Fix Loaded - ' + new Date().toISOString());
  const modal = document.querySelector('[data-quick-view-modal]');
  console.log('Modal element:', modal);
  if (modal) {
    console.log('âœ… MODAL FOUND! Quick view should work now.');
  } else {
    console.log('ðŸ”´ Modal still not found - check Elements tab');
  }
});
</script>

</head>
<body class="template-{{ template.name }}{% if template.suffix %} template-{{ template.name }}-{{ template.suffix }}{% endif %}">
  {%- comment -%} Skip link for keyboard/screen reader users {%- endcomment -%}
  <a class="skip-link visually-hidden" href="#main-content">Skip to content</a>

  {%- comment -%} Header Group (includes announcement bar, header, trust bar) {%- endcomment -%}
  {% sections 'header-group' %}

  {%- comment -%} Main Content {%- endcomment -%}
  <main id="main-content" role="main" tabindex="-1">
    {{ content_for_layout }}
  </main>

  {%- comment -%} Footer Group {%- endcomment -%}
  {% sections 'footer-group' %}

  {%- comment -%} Cart Drawer {%- endcomment -%}
  {% if settings.cart_type == 'drawer' %}
    {% section 'cart-drawer' %}
  {% endif %}

  {%- comment -%} Quick View Modal {%- endcomment -%}
  {% render 'quick-view' %}

  {%- comment -%} Back to Top Button {%- endcomment -%}
  {% render 'back-to-top' %}

  {%- comment -%} Cookie Consent Banner {%- endcomment -%}
  {% if settings.enable_cookie_banner %}
    {% render 'cookie-consent' %}
  {% endif %}

  {%- comment -%} Newsletter Popup {%- endcomment -%}
  {% if settings.enable_newsletter_popup %}
    {% render 'newsletter-popup' %}
  {% endif %}

  {%- comment -%} Product Compare Bar {%- endcomment -%}
  {% if settings.enable_compare %}
    {% render 'compare-bar' %}
  {% endif %}

  {%- comment -%} JSON-LD Structured Data {%- endcomment -%}
  {% render 'json-ld' %}

  {%- comment -%} Global JavaScript Config {%- endcomment -%}
  <script>
    window.theme = {
      moneyFormat: {{ shop.money_format | json }},
      cartType: {{ settings.cart_type | json }},
      routes: {
        cart: '/cart',
        cartAdd: '/cart/add.js',
        cartChange: '/cart/change.js',
        cartUpdate: '/cart/update.js',
        search: '/search/suggest.json'
      },
      strings: {
        addToCart: {{ 'products.product.add_to_cart' | t | json }},
        soldOut: {{ 'products.product.sold_out' | t | json }},
        unavailable: {{ 'products.product.unavailable' | t | json }},
        cartEmpty: {{ 'cart.general.empty' | t | json }},
        itemAdded: {{ 'cart.general.item_added' | t | json }}
      }
    };
  </script>

  {%- comment -%} Main JavaScript {%- endcomment -%}
  <script src="{{ 'theme.js' | asset_url }}" defer></script>

  {%- comment -%} Accessibility: Announce dynamic content changes {%- endcomment -%}
  <div id="aria-live-region" aria-live="polite" aria-atomic="true" class="visually-hidden"></div>
  
  </body>
</html>
