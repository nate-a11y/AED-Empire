<header class="header" data-header>
  <div class="header__main">
    <div class="container">
      <div class="header__inner">
        <button class="header__menu-toggle" data-menu-toggle aria-label="Open navigation menu" aria-expanded="false" aria-controls="mobile-menu">
          <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
        </button>

        {%- comment -%} Logo - Using Dawn best practices {%- endcomment -%}
        {%- if request.page_type == 'index' -%}<div class="header__heading">{%- endif -%}
        <a href="{{ routes.root_url }}" class="header__logo focus-inset" aria-label="{{ shop.name }} - Home">
          {%- if settings.logo != blank -%}
            {%- liquid
              assign logo_width = settings.logo_width | default: 180
              assign logo_width_mobile = settings.logo_width_mobile | default: 120
              assign logo_alt = settings.logo.alt | default: shop.name | escape
              assign logo_height = logo_width | divided_by: settings.logo.aspect_ratio | round
            -%}
            {%- capture sizes -%}(max-width: 749px) {{ logo_width_mobile }}px, {{ logo_width }}px{%- endcapture -%}
            {%- capture widths -%}{{ logo_width_mobile }}, {{ logo_width }}, {{ logo_width | times: 1.5 | round }}, {{ logo_width | times: 2 }}{%- endcapture -%}
            <div class="header__logo-wrapper">
              {{
                settings.logo
                | image_url: width: 600
                | image_tag:
                  class: 'header__logo-img',
                  widths: widths,
                  height: logo_height,
                  width: logo_width,
                  alt: logo_alt,
                  sizes: sizes,
                  preload: true
              }}
            </div>
          {%- else -%}
            <span class="header__logo-text">{{ shop.name }}</span>
          {%- endif -%}
        </a>
        {%- if request.page_type == 'index' -%}</h1>{%- endif -%}
        <style>
          .header__logo-wrapper { max-width: {{ settings.logo_width | default: 180 }}px; }
          .header__logo-img { width: 100%; height: auto; }
          @media (max-width: 749px) {
            .header__logo-wrapper { max-width: {{ settings.logo_width_mobile | default: 120 }}px; }
          }
        </style>

        {%- comment -%}
          Main Navigation - Uses menu selected in Theme Settings > Navigation
          Supports: Top-level items, dropdown menus (1 level deep)
          Menu structure: Shop, Services, Industries, About
        {%- endcomment -%}
        <nav class="header__nav" data-nav aria-label="Main navigation">
          <ul class="header__menu" role="menubar">
            {%- assign main_menu = linklists[settings.main_menu] -%}
            {%- for link in main_menu.links -%}
              {%- assign has_children = false -%}
              {%- if link.links != blank and link.links.size > 0 and settings.menu_enable_dropdowns -%}
                {%- assign has_children = true -%}
              {%- endif -%}

              {%- if has_children -%}
                {%- comment -%} Menu item with dropdown {%- endcomment -%}
                {%- assign dropdown_id = 'dropdown-' | append: forloop.index -%}
                <li class="header__menu-item header__menu-item--dropdown" role="none" data-dropdown>
                  <button class="header__dropdown-trigger" role="menuitem" aria-haspopup="true" aria-expanded="false" aria-controls="{{ dropdown_id }}">
                    {{ link.title }}
                    <svg class="header__dropdown-icon" aria-hidden="true" focusable="false" width="10" height="10" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
                  </button>
                  <ul class="header__dropdown" id="{{ dropdown_id }}" role="menu" aria-label="{{ link.title }} submenu">
                    {%- for child_link in link.links -%}
                      <li role="none">
                        <a href="{{ child_link.url }}" role="menuitem"{% if child_link.current %} aria-current="page"{% endif %}>
                          {{ child_link.title }}
                        </a>
                      </li>
                    {%- endfor -%}
                  </ul>
                </li>
              {%- else -%}
                {%- comment -%} Simple menu item without dropdown {%- endcomment -%}
                <li class="header__menu-item" role="none">
                  <a href="{{ link.url }}" role="menuitem"{% if link.current %} aria-current="page"{% endif %}>
                    {{ link.title }}
                  </a>
                </li>
              {%- endif -%}
            {%- endfor -%}
          </ul>
        </nav>

        <div class="header__actions">
          <button class="header__search-toggle" data-search-toggle aria-label="Open search" aria-expanded="false" aria-controls="predictive-search">
            <svg aria-hidden="true" focusable="false" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <circle cx="11" cy="11" r="8" style="stroke:#1a1a2e !important"/>
              <line x1="21" y1="21" x2="16.65" y2="16.65" style="stroke:#1a1a2e !important"/>
            </svg>
          </button>

          {% if shop.customer_accounts_enabled %}
            <a href="{% if customer %}/account{% else %}/account/login{% endif %}" class="header__account" aria-label="{% if customer %}My account{% else %}Log in{% endif %}">
              <svg aria-hidden="true" focusable="false" width="22" height="22" viewBox="0 0 24 24" fill="none" stroke-width="2">
                <path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2" style="stroke:#1a1a2e !important"/>
                <circle cx="12" cy="7" r="4" style="stroke:#1a1a2e !important"/>
              </svg>
            </a>
          {% endif %}

          {% if settings.contact_phone != blank %}
            <a href="tel:{{ settings.contact_phone | remove: ' ' | remove: '-' | remove: '(' | remove: ')' }}" class="header__phone" aria-label="Call us at {{ settings.contact_phone }}">
              <svg aria-hidden="true" focusable="false" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke-width="2">
                <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z" style="stroke:#1a1a2e !important"/>
              </svg>
              <span class="header__phone-text" aria-hidden="true">{{ settings.contact_phone }}</span>
            </a>
          {% endif %}

          <a href="{{ routes.cart_url }}" class="header__icon header__icon--cart" id="cart-icon-bubble" data-cart-toggle aria-label="Cart{% if cart.item_count > 0 %}, {{ cart.item_count }} item{% if cart.item_count != 1 %}s{% endif %}{% endif %}">
            <svg aria-hidden="true" focusable="false" class="icon icon-cart" width="24" height="24" viewBox="0 0 24 24" style="display:block;">
              <path d="M6 2L3 6v14a2 2 0 002 2h14a2 2 0 002-2V6l-3-4z" fill="none" style="stroke:#1a1a2e !important" stroke-width="2"/>
              <line x1="3" y1="6" x2="21" y2="6" style="stroke:#1a1a2e !important" stroke-width="2"/>
              <path d="M16 10a4 4 0 01-8 0" fill="none" style="stroke:#1a1a2e !important" stroke-width="2"/>
            </svg>
            <span class="visually-hidden">Cart</span>
            {%- if cart != empty -%}
              <span class="cart-count-bubble" data-cart-count data-count="{{ cart.item_count }}">
                <span aria-hidden="true">{{ cart.item_count }}</span>
              </span>
            {%- endif -%}
          </a>
        </div>
      </div>
    </div>
  </div>

  <!-- Predictive Search -->
  <div class="predictive-search" id="predictive-search" data-predictive-search hidden role="dialog" aria-label="Search" aria-modal="true">
    <div class="container">
      <div class="predictive-search__inner">
        <form action="/search" method="get" class="predictive-search__form" role="search">
          <label for="search-input" class="visually-hidden">Search products, collections...</label>
          <input type="search" id="search-input" name="q" placeholder="Search products, collections..." autocomplete="off" data-search-input aria-describedby="search-hint">
          <span id="search-hint" class="visually-hidden">Type to search. Results will appear below.</span>
          <button type="button" class="predictive-search__close" data-search-close aria-label="Close search">
            <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
              <line x1="18" y1="6" x2="6" y2="18" style="stroke:#1a1a2e !important"/>
              <line x1="6" y1="6" x2="18" y2="18" style="stroke:#1a1a2e !important"/>
            </svg>
          </button>
        </form>
        <div class="predictive-search__results" data-search-results role="listbox" aria-label="Search results"></div>
      </div>
    </div>
  </div>

  {%- comment -%}
    Mobile Menu - Uses same menu from Theme Settings > Navigation
    Accordion style for items with children
  {%- endcomment -%}
  <nav class="mobile-menu" id="mobile-menu" data-mobile-menu aria-label="Mobile navigation" aria-hidden="true">
    <div class="mobile-menu__header">
      <span id="mobile-menu-title">Menu</span>
      <button class="mobile-menu__close" data-menu-close aria-label="Close navigation menu">
        <svg aria-hidden="true" focusable="false" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke-width="2">
          <line x1="18" y1="6" x2="6" y2="18" style="stroke:#1a1a2e !important"/>
          <line x1="6" y1="6" x2="18" y2="18" style="stroke:#1a1a2e !important"/>
        </svg>
      </button>
    </div>
    <div class="mobile-menu__nav" role="menu" aria-labelledby="mobile-menu-title">
      {%- assign main_menu = linklists[settings.main_menu] -%}
      {%- for link in main_menu.links -%}
        {%- assign has_children = false -%}
        {%- if link.links != blank and link.links.size > 0 and settings.menu_enable_dropdowns -%}
          {%- assign has_children = true -%}
        {%- endif -%}

        {%- if has_children -%}
          {%- comment -%} Accordion item with children {%- endcomment -%}
          {%- assign accordion_id = 'mobile-accordion-' | append: forloop.index -%}
          <div class="mobile-menu__accordion">
            <button class="mobile-menu__accordion-trigger" aria-expanded="false" aria-controls="{{ accordion_id }}">
              {{ link.title }}
              <svg class="mobile-menu__accordion-icon" aria-hidden="true" focusable="false" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><polyline points="6 9 12 15 18 9"/></svg>
            </button>
            <div class="mobile-menu__accordion-content" id="{{ accordion_id }}" role="menu" aria-label="{{ link.title }} submenu">
              {%- for child_link in link.links -%}
                <a href="{{ child_link.url }}" role="menuitem"{% if child_link.current %} aria-current="page"{% endif %}>
                  {{ child_link.title }}
                </a>
              {%- endfor -%}
            </div>
          </div>
        {%- else -%}
          {%- comment -%} Simple link {%- endcomment -%}
          <a href="{{ link.url }}" class="mobile-menu__link" role="menuitem"{% if link.current %} aria-current="page"{% endif %}>
            {{ link.title }}
          </a>
        {%- endif -%}
      {%- endfor -%}
    </div>
    {%- if settings.contact_phone != blank -%}
      <a href="tel:{{ settings.contact_phone | remove: ' ' }}" class="mobile-menu__phone" aria-label="Call {{ settings.contact_phone }}">
        <svg aria-hidden="true" focusable="false" width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
          <path d="M22 16.92v3a2 2 0 01-2.18 2 19.79 19.79 0 01-8.63-3.07 19.5 19.5 0 01-6-6 19.79 19.79 0 01-3.07-8.67A2 2 0 014.11 2h3a2 2 0 012 1.72c.127.96.361 1.903.7 2.81a2 2 0 01-.45 2.11L8.09 9.91a16 16 0 006 6l1.27-1.27a2 2 0 012.11-.45c.907.339 1.85.573 2.81.7A2 2 0 0122 16.92z"/>
        </svg>
        <span aria-hidden="true">{{ settings.contact_phone }}</span>
      </a>
    {%- endif -%}
  </nav>
  <div class="mobile-menu__overlay" data-menu-overlay aria-hidden="true"></div>
</header>

{% schema %}
{
  "name": "Header",
  "settings": [
    {
      "type": "paragraph",
      "content": "Configure navigation in Theme Settings > Navigation. The main menu supports dropdown items (1 level deep)."
    }
  ],
  "presets": [{"name": "Header"}]
}
{% endschema %}
